<Window x:Class="Cleaning_Quote.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Cleaning_Quote"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="MainWindow" Height="1084" Width="800">
    <Window.Resources>
        <x:Array x:Key="RoomTypeOptions" Type="{x:Type sys:String}">
            <sys:String>Bathroom (Full)</sys:String>
            <sys:String>Bathroom (Half)</sys:String>
            <sys:String>Bathroom (Master - 2 sinks, glass/stone shower)</sys:String>
            <sys:String>Bedroom</sys:String>
            <sys:String>Bedroom (Master)</sys:String>
            <sys:String>Kitchen</sys:String>
            <sys:String>Living Room</sys:String>
            <sys:String>Dining Room</sys:String>
            <sys:String>Office</sys:String>
            <sys:String>Laundry</sys:String>
            <sys:String>Family Room</sys:String>
            <sys:String>Entry</sys:String>
            <sys:String>Hallway</sys:String>
            <sys:String>Garage</sys:String>
            <sys:String>Other</sys:String>
        </x:Array>
        <x:Array x:Key="LevelOptions" Type="{x:Type sys:String}">
            <sys:String>Basement</sys:String>
            <sys:String>Main Floor (1)</sys:String>
            <sys:String>Upstairs (2)</sys:String>
            <sys:String>Floor 3</sys:String>
            <sys:String>Floor 4</sys:String>
            <sys:String>Floor 5</sys:String>
        </x:Array>
        <x:Array x:Key="RoomSizeOptions" Type="{x:Type sys:String}">
            <sys:String>S</sys:String>
            <sys:String>M</sys:String>
            <sys:String>L</sys:String>
        </x:Array>
        <x:Array x:Key="ComplexityOptions" Type="{x:Type sys:Int32}">
            <sys:Int32>1</sys:Int32>
            <sys:Int32>2</sys:Int32>
            <sys:Int32>3</sys:Int32>
        </x:Array>
    </Window.Resources>
    <DockPanel Margin="10">
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_Settings">
                <MenuItem Header="Service Type Defaults..." Click="OpenServiceTypeDefaults_Click"/>
                <MenuItem Header="Complexity Reference..." Click="OpenComplexityReference_Click"/>
            </MenuItem>
        </Menu>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

        <!-- LEFT: Client Panel -->
        <StackPanel Grid.Column="0" Margin="10">
            <TextBlock Text="Search Clients" FontWeight="SemiBold"/>
            <TextBox x:Name="SearchBox"
                 Height="28"
                 Margin="0,2,0,8"
                 TextChanged="SearchBox_TextChanged"/>


            <ListBox x:Name="ClientsList" Height="140"
                 DisplayMemberPath="DisplayName"
                 SelectionChanged="ClientsList_SelectionChanged"/>

            <TextBlock Text="Client Details" FontSize="16" FontWeight="Bold" Margin="0,15,0,8"/>

            <TextBlock Text="Client Name" FontWeight="SemiBold"/>
            <TextBox x:Name="NameBox" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="Street Address" FontWeight="SemiBold"/>
            <TextBox x:Name="Addr1Box" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="Address Line 2 (optional)" FontWeight="SemiBold"/>
            <TextBox x:Name="Addr2Box" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="City" FontWeight="SemiBold"/>
            <TextBox x:Name="CityBox" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="State" FontWeight="SemiBold"/>
            <TextBox x:Name="StateBox" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="Zip Code" FontWeight="SemiBold"/>
            <TextBox x:Name="ZipBox" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="Phone Number" FontWeight="SemiBold"/>
            <TextBox x:Name="PhoneBox" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="Email Address" FontWeight="SemiBold"/>
            <TextBox x:Name="EmailBox" TextChanged="AnyField_TextChanged" Height="28" Margin="0,2,0,6"/>

            <TextBlock Text="Notes" FontWeight="SemiBold"/>
            <TextBox x:Name="NotesBox" TextChanged="AnyField_TextChanged"
                 Height="60"
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 Margin="0,2,0,10"/>

            <StackPanel Orientation="Horizontal">
                <Button Content="New" Width="80" Margin="0,0,8,0" Click="NewClient_Click"/>
                <Button x:Name="SaveButton"
                    Content="Save"
                    Width="80"
                    Click="SaveClient_Click"/>
                <Button Content="Delete" Width="80" Margin="8,0,0,0" Click="DeleteClient_Click"/>

            </StackPanel>

            <TextBlock Text="Quotes" FontSize="16" FontWeight="Bold" Margin="0,10,0,6"/>

            <ListBox x:Name="QuotesList"
                 Height="120"
                 DisplayMemberPath="DisplayText"
                 SelectionChanged="QuotesList_SelectionChanged"/>

            <StackPanel Orientation="Horizontal" Margin="0,6,0,0"/>

            <TextBlock x:Name="StatusText" Margin="0,10,0,0" />

            <StackPanel Orientation="Horizontal">
                <Button Content="New Quote" Width="100" Margin="0,0,8,0" Click="NewQuote_Click"/>
                <Button Content="Load Quote" Width="100" Margin="0,0,8,0" Click="LoadQuote_Click"/>
                <Button Content="Delete Quote" Width="100" Margin="8,0,0,0" Click="DeleteQuote_Click"/>
            </StackPanel>

        </StackPanel>
       
        <!-- RIGHT: Totals Panel (what you already had) -->
        <ScrollViewer Grid.Column="1"
                      Margin="10"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding QuotePanelVisibility}">
        <StackPanel>

            <TextBlock Text="Quote" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

            <GroupBox Header="Customer Details" Margin="0,0,0,10">
                <StackPanel Margin="10">
                    <WrapPanel Margin="0,0,0,6">
                        <TextBlock Text="Customer:" FontWeight="SemiBold" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding ClientDisplayName}" />
                    </WrapPanel>
                    <WrapPanel Margin="0,0,0,6">
                        <TextBlock Text="Address:" FontWeight="SemiBold" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding ClientAddressLine}" TextWrapping="Wrap" Width="360"/>
                    </WrapPanel>
                    <WrapPanel>
                        <TextBlock Text="Date:" FontWeight="SemiBold" Margin="0,0,6,0"/>
                        <DatePicker x:Name="QuoteDatePicker" SelectedDateChanged="QuoteDetails_Changed" Width="140"/>
                        <TextBlock Text="Total Sq Ft" FontWeight="SemiBold" Margin="16,0,6,0"/>
                        <TextBox x:Name="TotalSqFtBox" Width="90" Height="24" TextChanged="QuoteInputs_Changed"/>
                        <CheckBox x:Name="SqFtOverrideCheck" Content="Use Total Sq Ft" Margin="10,0,0,0"
                                  Checked="QuoteInputs_Changed" Unchecked="QuoteInputs_Changed"/>
                    </WrapPanel>
                    <WrapPanel Margin="0,6,0,0">
                        <TextBlock Text="Estimated Sq Ft (rooms):" FontWeight="SemiBold" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding EstimatedSqFtText}" />
                    </WrapPanel>
                </StackPanel>
            </GroupBox>

            <GroupBox Header="Discuss" Margin="0,0,0,10">
                <StackPanel Margin="10">
                    <StackPanel Margin="0,0,0,8">
                        <WrapPanel Margin="0,0,0,6">
                            <TextBlock Text="Pets" FontWeight="SemiBold" Width="100"/>
                            <CheckBox x:Name="PetsYesCheck" Content="Yes" Margin="0,0,10,0"
                                      Checked="PetsYesCheck_Changed" Unchecked="PetsYesCheck_Changed"/>
                            <CheckBox x:Name="PetsNoCheck" Content="No" Checked="PetsNoCheck_Changed" Unchecked="PetsNoCheck_Changed"/>
                        </WrapPanel>
                        <DataGrid x:Name="PetsGrid"
                                  Height="120"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  Visibility="Collapsed">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
                                <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="200"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0" Visibility="Collapsed" x:Name="PetsButtonsPanel">
                            <Button Content="Add Pet" Width="80" Margin="0,0,6,0" Click="AddPet_Click"/>
                            <Button Content="Remove Pet" Width="100" Click="RemovePet_Click"/>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Margin="0,0,0,8">
                        <WrapPanel Margin="0,0,0,6">
                            <TextBlock Text="Home Occupied" FontWeight="SemiBold" Width="120"/>
                            <CheckBox x:Name="OccupantsYesCheck" Content="Yes" Margin="0,0,10,0"
                                      Checked="OccupantsYesCheck_Changed" Unchecked="OccupantsYesCheck_Changed"/>
                            <CheckBox x:Name="OccupantsNoCheck" Content="No" Checked="OccupantsNoCheck_Changed" Unchecked="OccupantsNoCheck_Changed"/>
                        </WrapPanel>
                        <DataGrid x:Name="OccupantsGrid"
                                  Height="120"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  Visibility="Collapsed">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Relationship" Binding="{Binding Relationship}" Width="140"/>
                                <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="200"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0" Visibility="Collapsed" x:Name="OccupantsButtonsPanel">
                            <Button Content="Add Person" Width="90" Margin="0,0,6,0" Click="AddOccupant_Click"/>
                            <Button Content="Remove Person" Width="110" Click="RemoveOccupant_Click"/>
                        </StackPanel>
                    </StackPanel>

                    <WrapPanel Margin="0,0,0,6">
                        <TextBlock Text="Entry" FontWeight="SemiBold" Width="120"/>
                        <TextBox x:Name="EntryInstructionsBox" Width="280" Height="24" TextChanged="QuoteInputs_Changed"/>
                    </WrapPanel>
                    <WrapPanel Margin="0,0,0,6">
                        <TextBlock Text="Payment Method" FontWeight="SemiBold" Width="120"/>
                        <ComboBox x:Name="PaymentMethodBox" Width="180" SelectionChanged="PaymentMethodBox_SelectionChanged">
                            <ComboBoxItem>Zelle</ComboBoxItem>
                            <ComboBoxItem>Check</ComboBoxItem>
                            <ComboBoxItem>Credit Card</ComboBoxItem>
                            <ComboBoxItem>Cash</ComboBoxItem>
                            <ComboBoxItem>Other</ComboBoxItem>
                        </ComboBox>
                        <TextBox x:Name="PaymentMethodOtherBox" Width="160" Margin="10,0,0,0" Visibility="Collapsed"
                                 TextChanged="QuoteInputs_Changed" />
                    </WrapPanel>
                    <CheckBox x:Name="FeedbackDiscussedCheck"
                              Content="Feedback, we don't live here :) discussed"
                              Checked="QuoteInputs_Changed"
                              Unchecked="QuoteInputs_Changed"/>
                </StackPanel>
            </GroupBox>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Button Content="Add Room" Width="90" Margin="0,0,8,0" Click="AddRoom_Click"/>
                <Button Content="Remove Room" Width="110" Margin="0,0,8,0" Click="RemoveRoom_Click"/>
                <Button Content="Save Quote" Width="95" Click="SaveQuote_Click"/>
            </StackPanel>

            <TextBlock Text="New Room Defaults" FontWeight="SemiBold" Margin="0,0,0,4"/>
            <WrapPanel Margin="0,0,0,10">
                <StackPanel Width="160" Margin="0,0,10,0">
                    <TextBlock Text="Room Type" FontWeight="SemiBold"/>
                    <ComboBox x:Name="DefaultRoomTypeBox" Height="26" ItemsSource="{StaticResource RoomTypeOptions}"/>
                </StackPanel>
                <StackPanel Width="150" Margin="0,0,10,0">
                    <TextBlock Text="Level" FontWeight="SemiBold"/>
                    <ComboBox x:Name="DefaultRoomLevelBox" Height="26" ItemsSource="{StaticResource LevelOptions}"/>
                </StackPanel>
                <StackPanel Width="90" Margin="0,0,10,0">
                    <TextBlock Text="Size" FontWeight="SemiBold"/>
                    <ComboBox x:Name="DefaultRoomSizeBox" Height="26" ItemsSource="{StaticResource RoomSizeOptions}"/>
                </StackPanel>
                <StackPanel Width="120" Margin="0,0,10,0">
                    <TextBlock Text="Complexity" FontWeight="SemiBold"/>
                    <ComboBox x:Name="DefaultRoomComplexityBox" Height="26" ItemsSource="{StaticResource ComplexityOptions}"/>
                </StackPanel>
            </WrapPanel>

            <!-- Quote settings -->
            <WrapPanel Margin="0,0,0,10">
                <StackPanel Width="130" Margin="0,0,10,0">
                    <TextBlock Text="Labor Rate ($/hr)" FontWeight="SemiBold"/>
                    <TextBox x:Name="LaborRateBox" Height="26" TextChanged="QuoteInputs_Changed"/>
                </StackPanel>

                <StackPanel Width="110" Margin="0,0,10,0">
                    <TextBlock Text="Tax Rate" FontWeight="SemiBold"/>
                    <TextBox x:Name="TaxRateBox" Height="26" TextChanged="QuoteInputs_Changed"/>
                </StackPanel>

                <StackPanel Width="140" Margin="0,0,10,0">
                    <TextBlock Text="CC Fee Rate" FontWeight="SemiBold"/>
                    <TextBox x:Name="CcFeeRateBox" Height="26" TextChanged="QuoteInputs_Changed"/>
                </StackPanel>

                <StackPanel Width="110" Margin="0,0,10,0">
                    <TextBlock Text="Pay w/ Card" FontWeight="SemiBold"/>
                    <CheckBox x:Name="CreditCardCheck" Checked="QuoteInputs_Changed" Unchecked="QuoteInputs_Changed"/>
                </StackPanel>

            </WrapPanel>

            <WrapPanel Margin="0,0,0,10">
                <StackPanel Width="270" Margin="0,0,10,0">
                    <TextBlock Text="Quote Name" FontWeight="SemiBold"/>
                    <TextBox x:Name="QuoteNameBox" Height="26" TextChanged="QuoteNameBox_TextChanged"/>
                </StackPanel>

                <StackPanel Width="190" Margin="0,0,10,0">
                    <TextBlock Text="Service Type" FontWeight="SemiBold"/>
                    <ComboBox x:Name="ServiceTypeBox" Height="26" SelectionChanged="QuoteDetails_Changed">
                        <ComboBoxItem>Standard Clean</ComboBoxItem>
                        <ComboBoxItem>Initial Clean (Standard Clean Items Only)</ComboBoxItem>
                        <ComboBoxItem>Deep Clean (one-time)</ComboBoxItem>
                        <ComboBoxItem>Deep Clean (post initial clean)</ComboBoxItem>
                        <ComboBoxItem>Deep Clean (Semi-Annual)</ComboBoxItem>
                        <ComboBoxItem>Deep Clean (Annual)</ComboBoxItem>
                        <ComboBoxItem>Light Clean (dusting and floors)</ComboBoxItem>
                        <ComboBoxItem>Move In/Out Clean</ComboBoxItem>
                        <ComboBoxItem>Pressure Washing</ComboBoxItem>
                        <ComboBoxItem>Organizing</ComboBoxItem>
                    </ComboBox>
                </StackPanel>

                <StackPanel Width="150" Margin="0,0,10,0">
                    <TextBlock Text="Frequency" FontWeight="SemiBold"/>
                    <ComboBox x:Name="ServiceFrequencyBox" Height="26" SelectionChanged="QuoteDetails_Changed">
                        <ComboBoxItem>Weekly</ComboBoxItem>
                        <ComboBoxItem>Bi-weekly</ComboBoxItem>
                        <ComboBoxItem>Every 4 weeks</ComboBoxItem>
                        <ComboBoxItem>Semi-Annual</ComboBoxItem>
                        <ComboBoxItem>Annual</ComboBoxItem>
                        <ComboBoxItem>One Time</ComboBoxItem>
                    </ComboBox>
                </StackPanel>

                <StackPanel Width="190" Margin="0,0,10,0">
                    <TextBlock Text="Last Professional Cleaning" FontWeight="SemiBold"/>
                    <ComboBox x:Name="LastProfessionalCleaningBox" Height="26" SelectionChanged="QuoteDetails_Changed">
                        <ComboBoxItem>&lt; 2 weeks</ComboBoxItem>
                        <ComboBoxItem>2 - 4 weeks</ComboBoxItem>
                        <ComboBoxItem>&gt;1 month</ComboBoxItem>
                        <ComboBoxItem>Never</ComboBoxItem>
                    </ComboBox>
                </StackPanel>
            </WrapPanel>

            <Expander Header="Service Type Settings" IsExpanded="False" Margin="0,0,0,10">
                <StackPanel>
                    <WrapPanel Margin="0,0,0,10">
                        <StackPanel Width="160" Margin="0,0,10,0">
                            <TextBlock Text="Sq Ft per Labor Hour" FontWeight="SemiBold"/>
                            <TextBox x:Name="SqFtPerLaborHourBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Small Sq Ft" FontWeight="SemiBold"/>
                            <TextBox x:Name="SizeSmallSqFtBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Medium Sq Ft" FontWeight="SemiBold"/>
                            <TextBox x:Name="SizeMediumSqFtBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Large Sq Ft" FontWeight="SemiBold"/>
                            <TextBox x:Name="SizeLargeSqFtBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                    </WrapPanel>

                    <WrapPanel Margin="0,0,0,10">
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Complexity 1x" FontWeight="SemiBold"/>
                            <TextBox x:Name="Complexity1MultiplierBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Complexity 2x" FontWeight="SemiBold"/>
                            <TextBox x:Name="Complexity2MultiplierBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Complexity 3x" FontWeight="SemiBold"/>
                            <TextBox x:Name="Complexity3MultiplierBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                    </WrapPanel>

                    <WrapPanel>
                        <StackPanel Width="140" Margin="0,0,10,0">
                            <TextBlock Text="Glass Shower Hours" FontWeight="SemiBold"/>
                            <TextBox x:Name="FullGlassShowerHoursBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="140" Margin="0,0,10,0">
                            <TextBlock Text="Pebble Floor Hours" FontWeight="SemiBold"/>
                            <TextBox x:Name="PebbleStoneFloorHoursBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Fridge Hours" FontWeight="SemiBold"/>
                            <TextBox x:Name="FridgeHoursBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                        <StackPanel Width="120" Margin="0,0,10,0">
                            <TextBlock Text="Oven Hours" FontWeight="SemiBold"/>
                            <TextBox x:Name="OvenHoursBox" Height="26" TextChanged="ServiceTypeSettings_Changed"/>
                        </StackPanel>
                    </WrapPanel>
                </StackPanel>
            </Expander>

            <!-- Rooms -->
            <TextBlock Text="Room Details" FontWeight="Bold" Margin="0,0,0,6"/>
            <DataGrid x:Name="RoomsGrid"
              Height="170"
              AutoGenerateColumns="False"
              CanUserAddRows="False"
              SelectionMode="Single"
              AllowDrop="True"
              CellEditEnding="RoomsGrid_CellEditEnding"
              CurrentCellChanged="RoomsGrid_CurrentCellChanged"
              PreviewMouseLeftButtonDown="RoomsGrid_PreviewMouseLeftButtonDown"
              MouseMove="RoomsGrid_MouseMove"
              Drop="RoomsGrid_Drop">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Row" Width="60"
                        Binding="{Binding SortOrder}" IsReadOnly="True"/>
                    <DataGridComboBoxColumn Header="Level" Width="140"
                        ItemsSource="{StaticResource LevelOptions}"
                        SelectedItemBinding="{Binding Level, UpdateSourceTrigger=PropertyChanged}"/>

                    <DataGridTemplateColumn Header="Room" Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding RoomType}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Margin" Value="0,0,0,0"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSubItem}" Value="True">
                                                    <Setter Property="Margin" Value="16,0,0,0"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <DataGridTemplateColumn.CellEditingTemplate>
                            <DataTemplate>
                                <ComboBox ItemsSource="{StaticResource RoomTypeOptions}"
                                          IsEditable="True"
                                          Text="{Binding RoomType, UpdateSourceTrigger=PropertyChanged}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellEditingTemplate>
                    </DataGridTemplateColumn>

                    <DataGridComboBoxColumn Header="Size"
                        Width="70"
                        ItemsSource="{StaticResource RoomSizeOptions}"
                        SelectedItemBinding="{Binding Size, UpdateSourceTrigger=PropertyChanged}"/>

                    <DataGridComboBoxColumn Header="Complexity"
                        Width="90"
                        ItemsSource="{StaticResource ComplexityOptions}"
                        SelectedItemBinding="{Binding Complexity, UpdateSourceTrigger=PropertyChanged}"/>
                    <DataGridTextColumn Header="Est. Time" Binding="{Binding RoomLaborHours}" IsReadOnly="True" Width="80"/>
                    <DataGridTextColumn Header="Notes" Binding="{Binding RoomNotes}" Width="150"/>
                    <DataGridTextColumn Header="$ Amount" Binding="{Binding RoomAmount, StringFormat=C}" IsReadOnly="True" Width="90"/>
                </DataGrid.Columns>
            </DataGrid>

            <GroupBox Header="Add Room Sub-Item" Margin="0,8,0,0">
                <StackPanel Margin="10">
                    <WrapPanel Margin="0,0,0,6">
                        <TextBlock Text="Sub-Item" FontWeight="SemiBold" Width="80"/>
                        <ComboBox x:Name="SubItemTypeBox" Width="200">
                            <ComboBoxItem>Ceiling Fan</ComboBoxItem>
                            <ComboBoxItem>Fridge</ComboBoxItem>
                            <ComboBoxItem>Mirror +1</ComboBoxItem>
                            <ComboBoxItem>Oven</ComboBoxItem>
                            <ComboBoxItem>Shower: Discount (no glass)</ComboBoxItem>
                            <ComboBoxItem>Shower: Discount (no stone/tile)</ComboBoxItem>
                            <ComboBoxItem>Sink: Discount 1</ComboBoxItem>
                            <ComboBoxItem>Stove Top (Gas)</ComboBoxItem>
                            <ComboBoxItem>Tub / Jacuzzi Tub</ComboBoxItem>
                            <ComboBoxItem>Window (1 pane, inside only, 1st story)</ComboBoxItem>
                            <ComboBoxItem>Window (1 pane, outside only, 1st story)</ComboBoxItem>
                            <ComboBoxItem>Window (1 pane, inside only, 2nd story)</ComboBoxItem>
                            <ComboBoxItem>Window (1 pane, outside only, 2nd story)</ComboBoxItem>
                            <ComboBoxItem>Window Tract</ComboBoxItem>
                            <ComboBoxItem>Window: Standard (2 panes)</ComboBoxItem>
                        </ComboBox>
                        <TextBlock Text="Count" FontWeight="SemiBold" Margin="12,0,4,0"/>
                        <TextBox x:Name="SubItemCountBox" Width="40" Height="24" Text="1"/>
                    </WrapPanel>
                    <WrapPanel Margin="0,0,0,6">
                        <TextBlock Text="Window Size" FontWeight="SemiBold" Width="80"/>
                        <ComboBox x:Name="WindowSizeBox" Width="90">
                            <ComboBoxItem>S</ComboBoxItem>
                            <ComboBoxItem>M</ComboBoxItem>
                            <ComboBoxItem>L</ComboBoxItem>
                        </ComboBox>
                        <CheckBox x:Name="WindowInsideCheck" Content="Inside" Margin="10,0,0,0"/>
                        <CheckBox x:Name="WindowOutsideCheck" Content="Outside" Margin="10,0,0,0"/>
                        <Button Content="Add Sub-Item" Width="110" Margin="12,0,0,0" Click="AddSubItem_Click"/>
                    </WrapPanel>
                </StackPanel>
            </GroupBox>

            <!-- Totals -->
            <Border BorderThickness="1" Padding="10" Margin="0,10,0,0">
                <StackPanel>
                    <TextBlock Text="Totals" FontSize="16" FontWeight="Bold" Margin="0,0,0,6"/>
                    <TextBlock Text="{Binding HoursText}" />
                    <TextBlock Text="{Binding SubtotalText}" />
                    <TextBlock Text="{Binding CcFeeText}" />
                    <TextBlock Text="{Binding TaxText}" />
                    <TextBlock Text="{Binding TotalText}" FontWeight="Bold" Margin="0,6,0,0"/>
                    <TextBlock Text="{Binding MinimumWarningText}" Foreground="Red" FontStyle="Italic" />
                </StackPanel>
            </Border>

            <Border BorderThickness="1" Padding="10" Margin="0,10,0,0">
                <StackPanel>
                    <TextBlock Text="Quote Form Calculator" FontSize="16" FontWeight="Bold" Margin="0,0,0,6"/>
                    <TextBlock Text="{Binding SqFtCalcText}" />
                    <TextBlock Text="{Binding FirstCleanText}" />
                    <TextBlock Text="{Binding DeepCleanText}" />
                    <TextBlock Text="{Binding MaintenanceText}" />
                    <TextBlock Text="{Binding OneTimeDeepCleanText}" />
                    <TextBlock Text="{Binding WindowInsideText}" />
                    <TextBlock Text="{Binding WindowOutsideText}" />
                </StackPanel>
            </Border>

            <GroupBox Header="Special Notes" Margin="0,10,0,0">
                <TextBox x:Name="QuoteNotesBox" Height="90" TextWrapping="Wrap" AcceptsReturn="True"
                         TextChanged="QuoteInputs_Changed" Margin="10"/>
            </GroupBox>

        </StackPanel>
        </ScrollViewer>

        </Grid>
    </DockPanel>

</Window>
